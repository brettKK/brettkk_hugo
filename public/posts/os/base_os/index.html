<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <title>linux-base | brettkk</title>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">    
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="description" content="etcd架构分为4部分 http server store raft wal etcd使用场景 API：Et">
<meta name="generator" content="Hugo 0.72.0" />


  <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="stylesheet" href="/css/style.css">
<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/googlecode.min.css" rel="stylesheet">
<script src="https://cdn.bootcss.com/highlight.js/10.0.1/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>







  </head>
  
  <body>
    <nav class="navigation">
	
		<a href="/"> <span class="arrow">←</span>Home</a>
	
	<a href="/posts">Archive</a>
	<a href="/tags">Tags</a>
	<a href="/about">About</a>

	

	
</nav>


    <main class="main">
      

<section id="single">
    <h1 class="title">linux-base</h1>

    <div class="tip">
        <span>
          May 5, 2021 11:33
        </span>
        <span class="split">
          ·
        </span>
        <span>
          
            2161 words
          
        </span>
        <span class="split">
          ·
        </span>
        <span>
          5 minute read
        </span>
    </div>

    <div class="content" >
      <article class="content">
        <h3 id="linux-版本">Linux 版本</h3>

<p>uname -a 查看系统的版本</p>

<ul>
<li>debian/ubuntu</li>
<li>redhat/fedora/centos</li>
</ul>

<p>各种源码协议</p>

<ul>
<li>必须开源： LGPL Mozilla  GPL（不允许将 GPL 代码用于商业产品）</li>

<li><p>可以闭源： BSD MIT Apache（宽松）</p></li>

<li><p>ls = list</p>

<ul>
<li>ls -a (display all files)</li>
<li>ls -l (more infomation)</li>
<li>ls -lh (file size k)</li>
</ul></li>
</ul>

<h3 id="磁盘相关的命令">磁盘相关的命令</h3>

<ul>
<li>du 显示某个目录或者文件占用的磁盘空间

<ul>
<li>查看文件大小 与ls 的区别</li>
</ul></li>

<li><p>df 显示整个磁盘的使用情况</p></li>

<li><p>find</p>

<ul>
<li>以文件名查找 find . -name &quot;xx.txt&quot;</li>
<li>以文件从属关系查找 find . -user brett</li>
<li>以文件类型查找 find . -type f(普通文件，d目录文件，p管道文件)</li>
<li>以文件大小查找 find . -size -1M(小于1M的文件，+1M大于1M的文件)</li>
<li>以时间查找

<table>
<thead>
</thead>

<tbody>
<tr>

</tr>

<tr>

</tr>
</tbody>
</table></li>
<li>指定查找深度    -maxdepth, -mindepth</li>
<li>find与xargs结合

<ul>
<li>find . -name &quot;a.txt&quot; | grep 'key'</li>
<li>find . -name &quot;a.txt&quot; | xargs grep 'key'</li>
<li>find . -name &quot;a.txt&quot; | xargs rm</li>
</ul></li>
<li>find -exec 与其他命令结合使用

<ul>
<li>find . -name &quot;a.txt&quot; -exec rm  \;</li>
</ul></li>
</ul></li>
</ul>

<p>管道与xargs</p>

<ul>
<li>管道：将前面的标准输出作为后面的标准输入 echo &quot;--help&quot; | cat</li>

<li><p>xargs：将前面的标准输入作为后面命令的参数 echo &quot;--help&quot; | xargs cat</p></li>

<li><p>文件特殊权限</p>

<ul>
<li>suid</li>
<li>sgid</li>
<li>sticky</li>
</ul></li>

<li><p>用户权限-文件</p>

<ul>
<li>chown = change owner</li>
<li>chgrp = change group</li>
<li>chmod = change mode</li>
</ul></li>
</ul>

<hr>

<h3 id="有显示功能的命令">有显示功能的命令</h3>

<ul>
<li>cat</li>
<li>cut 按列分文件</li>
<li>head -n 5 a.txt</li>
<li>tail

<ul>
<li>tail -n 10 a.txt</li>
<li>tail -f xx.log | grep hello</li>
</ul></li>
<li>利用head和tail查看文件中3000-5000的行

<ul>
<li>cat a.txt | head -n 5000 | tail -n 2000</li>
<li>cat a.txt | tail -n + 3000 | head -n 2000</li>
</ul></li>
<li>sed也可以查看文件中特定的行

<ul>
<li>sed -n &quot;3000,5000p&quot; a.txt</li>
</ul></li>
<li>more , less(更新一点)，功能上没看到区别</li>
<li>grep -i 匹配时忽略大小写, --color</li>
<li>sort

<table>
<thead>
</thead>

<tbody>
<tr>

</tr>

<tr>

</tr>
</tbody>
</table></li>
<li>uniq = unique

<ul>
<li>uniq -c  (相同行爱在一起 所以前面是sort命令)</li>
</ul></li>
<li>wc = word count

<ul>
<li>wc -c</li>
<li>wc -l<br></li>
</ul></li>
<li>awk， sed功能有些复杂，可以google search...</li>
</ul>

<hr>

<h3 id="网络常用工具命令文件夹network">网络常用工具命令（文件夹network）</h3>

<ul>
<li>ss = socket statistics

<ul>
<li>用来显示处于活动状态的套接字信息</li>
<li>快，利用到了TCP协议栈中tcp_diag</li>
<li>ss -t 显示tcp连接</li>
</ul></li>
<li>nc 网络发包工具</li>
<li>netstat

<ul>
<li>netstat -an</li>
</ul></li>
<li>tcpdump</li>
</ul>

<hr>

<h3 id="进程相关的命令">进程相关的命令</h3>

<ul>
<li><p>ps</p>

<table>
<thead>
</thead>

<tbody>
<tr>

</tr>

<tr>

</tr>

<tr>

</tr>

<tr>

</tr>

<tr>

</tr>

<tr>

</tr>

<tr>

</tr>

<tr>

</tr>
</tbody>
</table>

<ul>
<li>ps -ef

<ul>
<li>UID PID PPID C(cpu) STIME TTY TIME(占用cpu的时间) CMD</li>
</ul></li>
<li>ps -lf pid  （显示线程）</li>
</ul></li>

<li><p>free 查看内存使用情况</p>

<ul>
<li>free -m (以mb为单位显示)</li>
<li>free -h ()</li>
</ul></li>

<li><p>lsof</p>

<ul>
<li>lsof -p pid 进程打开的文件</li>
<li>lsof -i:8080 打开某端口的进程</li>
</ul></li>

<li><p>查某个进程打开的端口号</p>

<ul>
<li>lsof -p pid|grep LISTEN</li>
<li>netstat -nltp |grep pid</li>
</ul></li>

<li><p>kill -l 显示可用的信号 (信号感觉都是与进程关闭有关系的)</p>

<ul>
<li>kill -9 pid   发送编号为9的信号，强制杀死进程 SIGKILL</li>
<li>kill -2  SIGINT  ctrl+c</li>
<li>kill -15 (kill的默认选项) SIGTREM</li>
</ul></li>

<li><p>SIGHUP：  终端挂起或者控制进程终止，通知session内的进程不再与终端关联</p></li>

<li><p>SIGINT: 进程中断， ctrl+C可以产生</p></li>

<li><p>SIGQUIT： 进程退出，ctrl+\  产生coredump文件</p></li>

<li><p>SIGILL:  进程在执行非法指令，比如尝试执行数据段</p></li>

<li><p>SIGSEGV: 段错误， 无效的内存引用</p></li>

<li><p>SIGTRAP： 由断点指令或其它陷阱（trap）指令产生. 由debugger使用</p></li>

<li><p>SIGKILL: 杀死进程， kill -9 pid， 不能忽略 uncatchable</p></li>

<li><p>SIGTERM: 杀死进程，可以被进程处理（忽略）, kill pid</p></li>

<li><p>SIGSTOP: 暂停进程， 不能忽略 uncatchable</p></li>

<li><p>SIGCHLD: 当子进程退出时，发送给父进程的信号。父进程可以waitpid处理，或者注册信号处理函数处理。父进程不处理，子进程变为僵尸进程。</p></li>

<li><p>SIGALRM:  timer time out</p></li>

<li><p>SIGABRT： 丢弃执行进程  调用abort函数生成的信号</p></li>

<li><p>SIGPIPE: 管道破裂: 写一个没有读端口的管道</p></li>

<li><p>SIGTSTP: 终止进程， ctrl+z</p></li>

<li><p>让进程在后台可靠的运行</p>

<ul>
<li>用户注销或者网络中断时，终端会收到HUP信号从而关闭所有子进程。</li>
<li>让进程忽略HUP信号 nohup</li>
<li>让进程在新的会话中，从而不成为此终端的子进程 setsid, 让运行的程序在新的session中</li>
</ul></li>

<li><p>用户自定义信号 SIGUSR1  SIGUSR2 redis中aof子进程 与 父进程通讯使用</p></li>
</ul>

<p>task_struct结构体对应与进程相关的信息</p>

<ul>
<li>创建进程 fork 子进程从父进程上继承了哪些内容？子进程与父进程的区别与联系</li>
<li>fork() pthread_create() 最后在linux中都是调用do_fork， copy_process方法

<ul>
<li>linux中创建线程与进程均需要走到copy——process方法</li>
<li>进程与线程，对于系统来说都是task， 与task_struct对应</li>
<li>do_fork

<ul>
<li>copy_process</li>
<li>复制的内容与参数flag相关
<br></li>
</ul></li>
</ul></li>
</ul>

<hr>

<ul>
<li>软连接，与硬连接有什么区别

<ul>
<li>ln -s source dist # 软连接 文件用户数据块中存放的内容是另一文件的路径名的指向，则该文件就是软连接</li>
<li>ln source dist # 硬连接 硬链接是有着相同 inode 号仅文件名不同的文件</li>
</ul></li>

<li><p>文件删除的条件</p>

<ul>
<li>文件有2个计数器，i_count（占有的进程数）, i_nlink（硬链接数），同时为0时删除文件</li>
</ul></li>

<li><p>proc目录下 查看进程的虚拟地址空间布局  cat /proc/pid/maps vm_area_struct</p></li>

<li><p>numa 架构（cpu 内存 非均匀访问） 多 CPU 系统下共享 BUS 带来的性能问题</p></li>
</ul>

<p>elf格式的文件</p>

<ul>
<li>core dump file</li>
<li>可执行文件</li>
<li>共享文件</li>
<li>重定向文件</li>
</ul>

<p>size 命令 输出可执行文件中的代码段，数据段，bss段的大小， 不包含堆和栈</p>

<p>.bss段不存在程序文件中，仅存在与内存中</p>

<p>cpu 寻址方式
寻址： 指令中操作数所在的真实位置，cpu怎么去找指令中的数据</p>

<p>七种</p>

<ul>
<li>立即数寻址（不用寻址）</li>
<li>寄存器寻址 （操作数存在了寄存器里，不用到内存寻址）</li>
<li>直接寻址 （直接给出操作数的内存地址）</li>
<li>寄存器间接寻址 （操作数的地址在寄存器，操作数在内存中）</li>
<li>寄存器相对寻址 （寄存器的内容+给定的位移量之和等于操作数的内存地址）</li>
<li>基址加变址寻址 （基址寄存器+变址寄存器内存之和等于操作数的内存地址）</li>
<li>相对基址变址寻址 （基址寄存器+变址寄存器+给定的位移量等于操作数的内存地址）</li>
</ul>

<hr>

<ul>
<li>计算机运算小数运算不准确的原因

<ul>
<li>因为一些十进制的小数无法转换为二进制数</li>
<li>循环小数 1/3 = 0.33333</li>
</ul></li>
<li>指针的值表示内存起始地址， 指针的类型表示从该起始地址到终止地址的内存尺寸</li>
</ul>

<hr>

<p>OS 提供了多用户多进程的良好稳定环境，但有一些技术想pass os...</p>

<ul>
<li>kernel bypass 绕过内核  intel 开发的DPDK SPDK

<ul>
<li>解决内核态上的网络栈上性能问题的一种思路</li>
<li>避免内核：包拷贝，系统调用，线程调度等性能损耗</li>
<li>dpdk ring buffer

<ul>
<li>array (内存连续存储，对cpu cache line友好)</li>
<li>size power of 2 for convinient calculate</li>
<li>padding struct obj for cache line 对齐</li>
<li>CAS (ABA 问题 额外增加stamp，类似version判断是否出现ABA)</li>
</ul></li>
</ul></li>
</ul>

      </article>
    </div>

    <div class="article-nav" id="article-nav-id">
        <nav class="hide-on-mobile section-nav">
          <h3 class="ml-1">Table of contents</h3>
            
        </nav>
    </div>

    
        <div class="tags">
            
                <a href="http://brettkk.github.io/tags/linux">linux</a>
            
        </div>
    

    <div class="post-comment">
      
             
      
      
      


<div class="post bg-white">
    <script src="https://utteranc.es/client.js"
          repo="brettkk/brettkk.github.io"
          issue-term="pathname"
          theme="github-light"
          crossorigin="anonymous"
          async>
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/utterance">comments powered by utterances.</a></noscript>
</div>
    </div>
    

</section>

<script>
	window.addEventListener('DOMContentLoaded', () => {
		const observerForTableOfContentActiveState = new IntersectionObserver(entries => {
			entries.forEach(entry => {
				const id = entry.target.getAttribute('id');

				if (entry.intersectionRatio > 0) {					
					clearActiveStatesInTableOfContents();				
					document.querySelector(`nav li a[href="#${id}"]`).parentElement.classList.add('active');
				}
			});
		});		
		document.querySelectorAll('h1[id],h2[id],h3[id],h4[id]').forEach((section) => {
			observerForTableOfContentActiveState.observe(section);
		});

	});

	function clearActiveStatesInTableOfContents() {
		document.querySelectorAll('nav li').forEach((section) => {
			section.classList.remove('active');
		});
	}
</script>


    </main>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script>
<footer id="footer">
    

    <p class="copyright">
    
       © Copyright 
       2021 
       <span class="split">
        <svg fill="#bbbbbb" width="15" height="15" version="1.1" id="heart-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">
  <path d="M13.91,6.75c-1.17,2.25-4.3,5.31-6.07,6.94c-0.1903,0.1718-0.4797,0.1718-0.67,0C5.39,12.06,2.26,9,1.09,6.75&#xA;&#x9;C-1.48,1.8,5-1.5,7.5,3.45C10-1.5,16.48,1.8,13.91,6.75z"/>
</svg>
       </span>
       
    
    </p>
    <p class="powerby">
        Powered by <a href="http://www.gohugo.io/">Hugo</a> Theme By <a href="https://github.com/nodejh/hugo-theme-cactus-plus">nodejh</a>
    </p>
</footer>

  </body>
</html>
